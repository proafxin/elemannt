\documentclass[elemannt.tex]{subfile}

\begin{document}
	\chapter{Bertrand to Tchebyscheff}
	We said before that \textit{almost} all natural numbers are composite. A major objective of this book is to discuss how often the primes occur. The same question has bugged mathematicians for a centuries. It was Gauss who first observed that the change in the distribution of primes in every interval $[x,x+1000]$ was around $1/\log{x}$. Thus, the rough estimate
		\begin{align*}
			\pi(x)
				& = \int\limits_{2}^{x}\dfrac{1}{\log{t}}dt
		\end{align*}
	was made which is now known as \index{Logarithmic integral}\textit{logarithmic integral}. Gauss conjectured (see \textcite[Page 37]{landau_1911}) around 1792 or 1793 that
		\begin{align*}
			\lim\limits_{x\to\infty}\dfrac{\pi(x)}{\dfrac{x}{\log{x}}}
				& = 1
		\end{align*}
	\textcite{tchebycheff_1852} is the first one to make any substantial progress on the matter. %But instead of going straight into discussing the findings of Tchebyscheff, we will first try to understand the reasoning behind his approach. It is very difficult to do so and there is no real concrete intuition behind it. But we will make an attempt anyway. Imagine you are given the numbers from $1$ to $n$. If one of these numbers was missing, we could find the missing number by subtracting the sum of the remaining numbers from the sum $1+\ldots+n$. Now what happens if two numbers go missing? Does the same technique apply? Let us give it a try. If $a$ and $b$ are the missing numbers, then we only know that the subtracted value is going to be $a+b$. However, there are $a+b-1$ possible pairs of positive integers for which $a+b$ can be achieved. So, how do we know exactly which pair is the answer? Definitely we need another clue for this. Now, if you were allowed to ask questions for getting clues (directly asking for the numbers is not allowed obviously), what kind of questions would you want to ask? Assume that you are allowed only one question in this scenario regarding only one of the numbers (again, except asking what the actual number is). One idea would be to ask what the multiple of that number (say, multiple of $3$) is. But this is again asking for the numbers directly. So assume that this type of questioning is also not allowed either. But now we can ask questions such as what is the sum when the first number multiplied by $3$ is added to the second number? We can form equations from such questions and then easily find the answers. Let us now make this a little more challenging. Imagine the same problem, except now you do not have to find the numbers explicitly. Rather you just have to find the number of missing numbers. However, you can ask fewer questions this time. What should be our approach now? If we just keep randomly asking questions to form linear equations like before, we will run out of questions sooner.
	In fact, Tchebyscheff was close to proving the prime number theorem himself. \textcite{tschebischeff_1852} proved that if $\pi(x)$ was of order $\frac{x}{\log^{N}{x}}$ as $x\to\infty$, then $N=1$. Consequently, he also proved that if the limit
		\begin{align*}
			\lim_{x\to\infty}\dfrac{x}{\log{x}}
		\end{align*}
	exists, then it is $1$. The only problem was to actually prove that this limit indeed exists. One of our objectives in this book is prove the prime number theorem without any serious analysis from the scratch. We will discuss some relevant results first that give us better insight into the structure of primes before doing that.
		\subfile{prime.tex}
	We can now start proving some results by \textcite{tchebycheff_1852} and \textcite{tschebischeff_1852}. Before we discuss Tchebyscheff's functions, we should discuss the following first which gives us some insight into why Tchebyscheff's functions are important.
		\begin{theorem}[Tchebyscheff]\label{thm:tchebycheffbound}
			Let $x$ be a positive real number. Then there are constants $a$ and $A$ such that
				\begin{align*}
					a\dfrac{x}{\log{x}}
						& \leq \pi(x) \leq A\dfrac{x}{\log{x}}
				\end{align*}
		\end{theorem}
	Actually, Tchebyscheff gave a more precise statement that
		\begin{align*}
			a
				& < \dfrac{\pi(x)}{\dfrac{x}{\log{x}}} < \dfrac{6a}{5}
		\end{align*}
	holds for large enough $x$ where
		\begin{align*}
			a
				& = \dfrac{\log{2}}{2}+\dfrac{\log{3}}{3}+\dfrac{\log{5}}{5}-\dfrac{\log{30}}{30}
		\end{align*}
	The following proof is inspired by \textcite[Theorem 112]{landau_1969}; which is a translation of the first section of the first volume of \textcite{landau_1927}.
		\begin{proof}
			For any $x\geq 0$,
				\begin{align*}
					\floor{x}-2\floor{\dfrac{x}{2}}
						& \leq 1
				\end{align*}
			since
				\begin{align*}
					\floor{x}-2\floor{\dfrac{x}{2}}
						& < x-2\parenthesis{\dfrac{x}{2}-1}\\
						& = 2
				\end{align*}
			Let $n\geq2$. For every $p\leq2n$, let $r$ denote the largest positive integer such that $p^{r}\leq2n$ (which is $\floor{\log{2n}/\log{p}}$). We will first show that
				\begin{align}
					\prod_{n<p\leq 2n}p
						& \mid \binom{2n}{n}\label{eqn:1}\\
					\binom{2n}{n}
						& \mid \prod_{p\leq 2n}p^{r}
				\end{align}
			where the products run through the primes only. For a prime $p$,
				\begin{align*}
					\nu_{p}\parenthesis{\binom{2n}{n}}
						& = \nu_{p}((2n)!)-2\nu_{p}(n!)
				\end{align*}
			Since $p>n$, $\nu_{p}(n!)=0$ and $\nu_{p}\func{}{\binom{2n}{n}}=\nu_{p}((2n)!)\geq\nu_{p}\func{}{\prod_{n<p\leq 2n}p}$. On the other hand, for $p\leq 2n$, using \nameref{thm:legendrefact},
				\begin{align*}
					\nu_{p}\func{}{\binom{2n}{n}}
						& = \nu_{p}((2n)!)-2\nu_{p}(n!)\\
						& = \sum_{i\geq 1}\floor{\dfrac{2n}{p^{i}}}-2\floor{\dfrac{n}{p^{i}}}
				\end{align*}
			Since $\floor{2x}-2\floor{x}\leq 1$ for any $x\geq0$ and $\nu_{p^{i}}((2n)!)=0$ for $i>r$, we have
				\begin{align*}
					\sum_{i\geq 1}\floor{\dfrac{2n}{p^{i}}}-2\floor{\dfrac{n}{p^{i}}}
						& \leq \sum_{1\leq i\leq r}1
				\end{align*}
			Thus, for every prime $p$,
				\begin{align*}
					p^{\nu_{p}\func{}{\binom{2n}{n}}}
						& \mid p^{r}
				\end{align*}
			and evidently
				\begin{align*}
					\binom{2n}{n}
						& \mid \prod_{p\leq 2n}p^{r}
				\end{align*}
			Now, there are $\pi(2n)-\pi(n)$ primes in the interval $(n,2n)$ each of which are greater than $n$. So,
				\begin{align*}
					n^{\pi(2n)-\pi(n)}
						& \leq \prod_{n<p\leq 2n}p\\
						& \leq\binom{2n}{n}\\
						& \leq \prod_{n<p\leq 2n}p^{\floor{\log_{p}{2n}}}\\
						& \leq (2n)^{\pi(2n)}
				\end{align*}
			Taking logarithm,
				\begin{align*}
					\func{}{\pi(2n)-\pi(n)}\log{n}
						& \leq \pi(2n)\log{2n}
				\end{align*}
			Next, we have that
				\begin{align*}
					\binom{2n}{n}
						& \leq \sum_{i=0}^{2n}\binom{2n}{i}\\
						& = 2^{2n}\\
					\binom{2n}{n}
						& = \dfrac{(n+1)\cdots (2n)}{1\cdots n}\\
						& \geq \prod_{i=1}^{n}\dfrac{n+i}{i}\\
						& \geq 2^{n}
				\end{align*}
			giving
				\begin{align*}
					(\pi(2n)-\pi(n))\log{n}
						& \leq\log{\binom{2n}{n}}\leq\pi(2n)\log{2n}
				\end{align*}
			Thus, we have
				\begin{align*}
					(\pi(2n)-\pi(n))\log{n}
						& \leq \log{2^{2n}}
				\end{align*}
			and also
				\begin{align*}
					\pi(2n)\log{2n}
						& \geq \log{2^{n}}\\
					\pi(2n)
						& \geq c_{1}\dfrac{2n}{\log{2n}}
				\end{align*}
			for a positive constant $c_{1}$. For $x\geq2$, setting $\eta=\floor{x/2}$ and $x=2\eta+r$ with $0\leq r<2$, we have $x\leq3\eta$ and $\log{2\eta}\leq\log{x}$.
				\begin{align*}
					\pi(x)
						& \geq\func{\pi}{2\eta}\\
						& \geq c\dfrac{2\eta}{\log{2\eta}}\\
						& = \dfrac{2c}{3}\dfrac{3\eta}{\log{2\eta}}\\
						& \geq a\dfrac{x}{\log{x}}
				\end{align*}
			for a positive constant $a$. On the other hand, since $x<2+2\floor{\frac{x}{2}}$,
				\begin{align*}
					\pi(x)-\func{\pi}{\dfrac{x}{2}}
						& = \pi(x)-\func{\pi}{\floor{\dfrac{x}{2}}}\\
						& \leq 2+\func{\pi}{2\floor{\dfrac{x}{2}}}-\func{\pi}{\floor{\dfrac{x}{2}}}\\
						& \leq 2+2\log{2}\dfrac{\floor{\dfrac{x}{2}}}{\log{\floor{\dfrac{x}{2}}}}\\
						& < d\dfrac{x}{log{x}}
				\end{align*}
			for a constant $d$. Using $\func{\pi}{\frac{x}{2}}\leq\frac{x}{2}$,
				\begin{align*}
					\log{x}\pi(x)-\log{\frac{x}{2}}\func{\pi}{\dfrac{x}{2}}
						& = \func{\log{x}}{\pi(x)-\func{\pi}{\dfrac{x}{2}}}+\log{2}\cdot\func{\pi}{\dfrac{x}{2}}\\
						& < \log{x}\cdot d_{1}\dfrac{x}{\log{x}}+\dfrac{x}{2}\\
						& < d_{2}x
				\end{align*}
			If $2^{m+1}\leq2^{v+1}x<2^{v+2}$ (that is, $v+1=\floor{\log_{2}{x}})$,
				\begin{align*}
					\log{\dfrac{x}{2^{m}}}\func{\pi}{\dfrac{x}{2^{m}}}-\log{\dfrac{x}{2^{m+1}}}\func{\pi}{\dfrac{x}{2^{m+1}}}
						& < d_{2}\dfrac{x}{2^{m}}
				\end{align*}
			Summing over this for $0\leq m\leq v$,
				\begin{align*}
					\log{x}\pi(x)
						& = \func{\sum_{m=0}^{v}}{\log{\dfrac{x}{2^{m}}}\func{\pi}{\dfrac{x}{2^{m}}}-\log{\dfrac{x}{2^{m+1}}}\func{\pi}{\dfrac{x}{2^{m+1}}}}\\
						& < d_{2}x\sum_{m=0}^{v}\dfrac{1}{2^{m}}\\
						& = Ax
				\end{align*}
		\end{proof}
	A corollary is the following.
		\begin{theorem}
			For a positive integer $n>1$,
				\begin{align*}
					bn\log{n}
						& < p_{n}<Bn\log{n}
				\end{align*}
		\end{theorem}
	The proof is left to the reader as an exercise. Using this, we can prove Euler's divergence of sum of reciprocals of prime theorem. Since
		\begin{align*}
			\dfrac{1}{p_{n}}
				& > \dfrac{1}{Bn\log{n}}
		\end{align*}
	we only need to show that
		\begin{align*}
			\sum_{n\geq1}\dfrac{1}{n\log{n}}
		\end{align*}
	diverges. This is also left to the reader as an exercise.

	\section{Tchebyscheff Functions}
	\textcite{tschebischeff_1852} defines two functions that are today known as Tchebisceff's $\vartheta$ and $\psi$ functions.
		\begin{definition}[Tchebyscheff's $\vartheta$ function]
			For a real number $x$, Tchebyscheff's $\vartheta$ function is defined as
				\begin{align*}
					\vartheta(x)
						& = \sum_{p\leq x}\log{p}
				\end{align*}
		\end{definition}

		\begin{definition}[Tchebyscheff's $\psi$ function]
			For a real number $x$, Tchebyscheff's $\psi$ function is defined as
				\begin{align*}
					\psi(x)
						& = \sum_{p^{i}\leq n}\log{p}
				\end{align*}
		\end{definition}
	Note that we can write $\psi$ in different ways.
		\begin{align*}
			\psi(x)
				& = \sum_{p\leq x}\log{p}\sum_{p^{i}\leq x}1\\
				& = \sum_{p\leq x}\floor{\log_{p}{x}}\log{p}
		\end{align*}
	Also,
		\begin{align*}
			\psi(x)
				& = \sum_{i\geq 1}\sum_{p^{i}\leq x}\log{p}\\
				& = \sum_{i\geq 1}\sum_{p\leq\sqrt[i]{x}}\log{p}\\
				& = \sum_{i\geq 1}\vartheta(\sqrt[i]{x})
		\end{align*}
	At this point, we should introduce the Von Mangoldt function.
		\begin{definition}[Von Mangoldt function]
			For a positive integer $n$,
				\begin{align*}
					\Lambda(n)
						& = \log{p}\mbox{ if }n=p^{k}\mbox{ for a prime }p\\
						& = 0\mbox{ otherwise}
				\end{align*}
		\end{definition}
	Then we can write $\psi$ as
		\begin{align*}
			\vartheta(x)
				& = \sum_{n\leq x}\Lambda(n)
		\end{align*}
	The following theorem immediately shows us the importance of these functions.
		\begin{theorem}\label{thm:pntequivalence}
			If any of the three limits
				\begin{align*}
					\lim_{x\to\infty}\dfrac{\pi(x)}{\dfrac{x}{\log{x}}}
						& ,\lim_{x\to\infty}\dfrac{\vartheta(x)}{x}, \lim_{x\to\infty}\dfrac{\psi(x)}{x}
				\end{align*}
			exists, then all three limits are equal.
		\end{theorem}

		\begin{proof}
			Let the upper limits of the three be $l_{1},l_{2},l_{3}$ respectively. Obviously,
				\begin{align*}
					\vartheta(x)
						& \leq \psi(x)\\
						& = \sum_{p\leq x}\floor{\dfrac{\log{x}}{\log{p}}}\log{p}\\
						& \leq\sum_{p\leq x}\dfrac{\log{x}}{\log{p}}\log{p}\\
						& =\log{x}\sum_{p\leq x}1\\
						& = \pi(x)\log{x}
				\end{align*}
			Then, for all $x$,
				\begin{align*}
					\dfrac{\vartheta(x)}{x}
						& \leq \dfrac{\psi(x)}{x}\leq \dfrac{\pi(x)}{\dfrac{x}{\log{x}}}
				\end{align*}
			So, $l_{2}\leq l_{3}\leq l_{1}$. Now, for any $0<\epsilon<1$, $\vartheta(x^{\epsilon})\geq0$ so $\vartheta(x)-\vartheta(x^{\epsilon})\leq \vartheta(x)$.
				\begin{align*}
					\vartheta(x)-\vartheta(x^{\epsilon})
						& =\sum_{x^{\epsilon}<p\leq x}\log{p}\\
						& > \sum_{x^{\epsilon}<p\leq x}\log{x^{\epsilon}}\\
						& = \log{x^{\epsilon}}\sum_{x^{\epsilon}<p\leq x}1\\
						& = \epsilon(\pi(x)-\pi(x^{\epsilon}))\log{x}
				\end{align*}
			Here, $\pi(x^{\epsilon})<x^{\epsilon}$ so $\pi(x)-\pi(x^{\epsilon})\geq \pi(x)-x^{\epsilon}$ and
				\begin{align*}
					\dfrac{\vartheta(x)}{x}
						& > \epsilon\left(\dfrac{\pi(x)}{\dfrac{x}{\log{x}}}-\dfrac{\log{x}}{x^{1-\epsilon}}\right)
				\end{align*}
			Taking $x\to\infty$, $\lim_{x\to\infty}\frac{\log{x}}{x^{1-\epsilon}}=0$ so
				\begin{align*}
					\lim_{x\to\infty}\dfrac{\vartheta(x)}{x}
						& \geq \epsilon \dfrac{\pi(x)}{\dfrac{x}{\log{x}}}
				\end{align*}
			Therefore, $l_{2}\geq l_{1}$ so $l_{1}=l_{2}$ and so $l_{3}=l_{2}=l_{1}$.
		\end{proof}
	$\vartheta$ and $\psi$ are discussed in every book on analytic number theory, however, it is never discussed why Tchebyscheff would consider these functions to begin with. Like most notable mathematical discovery, this was not a blind attempt by Tchebyscheff and he did not suddenly receive divine knowledge one night either. So there must be some explanation of how he thought of these functions and why they are so crucial in the study of prime numbers. Initially, I wanted to discuss a rationalization how Tchebyscheff might have thought of them. But I think it is more appropriate if we leave it as an open question to the reader to come up with such a rationalization how we might come up with such functions if we were to prove the prime number theorem. \textcite[pp. 13]{ingham_1932} says the following about this matter:
		\begin{quote}
			It happens (as will appear more clearly in $\S7$) that, of the three functions $\pi,\vartheta,\psi$, the one which arises most naturally from the analytical point of view is the most remote from the original problem, namely $\psi$. For this reason, it is usually most convenient to work in the first instance with $\psi$ and to use Theorem 3 (or more precise relations corresponding to the degree of approximation contemplated) to deduce the results about $\pi$. This is a complication which seems inherent in the subject, and the reader should familiarize himself at the outset with the function $\psi$, which is to be regarded as the fundamental one.
		\end{quote}
	One of the goals of Tchebyscheff's work was to prove a postulate by \textcite{bertrand_1845}.
		\begin{conjecture}[Bertrand's postulate]\label{con:bertrand}
			For any real number $x>1$, there is a prime $p$ such that $n<p<2n$.
		\end{conjecture}
	Note that \autoref{thm:tchebycheffbound} already implies \nameref{con:bertrand} if we can show that $A\leq 2a$. Because then $\vartheta\left(\frac{Ax}{a}\right)>\vartheta(x)$ so there must be a prime between $x$ and $cx$ for some constant $c\leq 2$. However, we will show that the direct approach in the proof of \autoref{thm:tchebycheffbound} does not produce a proof for this postulate.
			With the help of \autoref{thm:pntequivalence}, it is enough to show that there exist constants $a$ and $A$ such that $A\leq 2a$ and
				\begin{align*}
					ax
					& < \vartheta(x) < Ax
				\end{align*}
			We again consider the binomial coefficient $\binom{2n}{n}$ and use the trivial fact $\binom{2n}{n}<2^{2n}$. If $p$ is a prime such that $n<p<2n$, then
				\begin{align*}
					\nu_{p}\left(\binom{2n}{n}\right)
						& = \nu_{p}((2n)!)-2\nu_{p}(n!)\\
						& = \nu_{p}((2n)!)
				\end{align*}
			So, $\binom{2n}{n}$ is divisible by all such primes $p$. Thus,
				\begin{align*}
					\binom{2n}{n}
						& \geq \prod_{n<p<2n}p
				\end{align*}
			Since $\log{\binom{2n}{n}}<2n\log{2}$,
				\begin{align*}
					2n\log{2}
						& > \sum_{n<p<2n}\log{p}\\
						& = \vartheta(2n)-\vartheta(n)
				\end{align*}
			The right side can be telescoped by setting $n:=2^{i}$ for $0\leq i\leq  k-1$.
				\begin{align*}
					\sum_{i=0}^{k-1}2^{i+1}\log{2}
						& > \vartheta(2^{k})
				\end{align*}
			Since $2^{k}>1+\ldots+2^{k-1}$,
				\begin{align*}
					2^{k+1}\log{2}
						& > \vartheta(2^{k})
				\end{align*}
			For any $x>1$, taking $2^{k-1}\leq x<2^{k}$, $2^{k+1}\leq 4x$ so $\vartheta(x)\leq\vartheta(2^{k})<4x\log{2}$ and $\vartheta(x)<Ax$ for some $A\leq 4\log{2}$.

			Again, for a prime $p$, letting $r$ be the largest positive integer such that $p^{r}\leq 2n$, similar to the proof of \autoref{thm:tchebycheffbound}, $\nu_{p}\left(\binom{2n}{n}\right)\leq r$. From the definition,
				\begin{align*}
					e^{\psi(2n)}
						& = \prod_{p\leq 2n}p^{r}
				\end{align*}
			so $\binom{2n}{n}\mid e^{\psi(2n)}$. Also, $(2n+1)\binom{2n}{n}\geq 2^{2n}$ so
				\begin{align*}
					(2n+1)e^{\psi(2n)}
						& \geq 2^{2n}
				\end{align*}
			Taking logarithm,
				\begin{align*}
					\log{(2n+1)}+\psi(2n)
						& \geq 2n\log{2}
				\end{align*}
			Letting $\floor{\frac{x}{2}}=n$, we have $\psi(x)\geq\psi(2n)$, $2n>x-2$ and
				\begin{align*}
					\psi(x)
						& \geq (x-1)\log{2}-\log{(x+1)}
				\end{align*}
	We can now show that $\psi(x)\geq ax$ for some $a\geq\log{2}$. However, this only gives us the bound $\frac{A}{a}\leq4$ which does not prove \nameref{con:bertrand}. \textcite[$\S4$, eqn. $(5)$ pp. 376]{tschebischeff_1852} showed that $A\leq\frac{6}{5}a$ where
		\begin{align*}
			a
				& \geq \log{\dfrac{2^{\frac{1}{2}}3^{\frac{1}{3}}5^{\frac{1}{5}}}{30^{\frac{1}{30}}}}
		\end{align*}

	It was \textcite{erdos_1932} who introduced himself to the mathematical world by proving \nameref{con:bertrand} in a completely elementary manner using only properties of binomial coefficients.
		\begin{proof}

		\end{proof}
	\textcite{mertens_1874} gave more precise results than \nameref{thm:primereciprocal}.
		\begin{theorem}[Mertens' theorems]\label{thm:mertens}
			Let $x$ be a positive real number. As $x\to\infty$,
			\begin{align}
				\sum_{p\leq x}\dfrac{1}{p}
				& = \log{\log{x}}+B+\bigo{\dfrac{1}{x}}\label{eqn:mertens1}\\
				\sum_{p\leq x}\dfrac{\log{p}}{p}
				& = \log{x}+O(1)\label{eqn:mertens2}\\
				\prod_{p\leq x}\left(1-\dfrac{1}{p}\right)
				& \sim \dfrac{e^{-\gamma}}{\log{x}}\label{eqn:mertens3}
			\end{align}
			where $B$ is a constant and $\gamma$ is Euler-Mascheroni constant.
		\end{theorem}

		\begin{proof}
			From \nameref{thm:stirling},
			\begin{align*}
				\log{n!}
				& = n\log{n}-n+\bigo{n}
			\end{align*}
			Also, from \nameref{thm:legendrefact},
			\begin{align*}
				\log{n!}
				& = \sum_{p^{i}\leq n}\floor{\dfrac{n}{p^{i}}}\log{p}\\
				& = \sum_{i\leq n}\Lambda(n)\floor{\dfrac{n}{i}}
			\end{align*}
		\end{proof}
\end{document}